# Repository Guidelines

## Project Structure & Module Organization
`cmd/main.go` запускает watcher fsnotify и очередь конвертации. Логика разбита по `internal/`: `convert.go` управляет пайплайном из ZIP в CBZ, `cbz.go` собирает архив, `epub.go` оставлен для будущих форматов, `anilist.go` и `shikimori.go` тянут метаданные, `utils.go` предоставляет общие вспомогатели. Используйте `input/` для входящих архивов и `output/` для готовых CBZ; `bin/` хранит локальные сборки, а `workdir/` зарезервирован как временный том Docker. Корневые `Dockerfile` и `docker-compose.yml` повторяют локальный запуск внутри контейнера.

## Build, Test, and Development Commands
- `go build -o bin/converter ./cmd` — собирает бинарник с учетом текущего модуля.
- `go run ./cmd` — запускает watcher и немедленно обрабатывает архивы из `input/`.
- `go fmt ./...` и `go vet ./...` — базовая проверка форматирования и анализа перед PR.
- `docker compose up` — поднимает контейнер, монтируя `input/` и `output/` из хоста.

## Coding Style & Naming Conventions
Придерживайтесь стандартного Go-стиля: табуляция (IDE должен применять `gofmt`). Экспортируемые сущности оформляйте в PascalCase с комментариями формата `Name ...`. Внутренние функции и файлы — camelCase и короткие, говорящие имена. Новые пакеты размещайте в `internal/`; избегайте циклических зависимостей и оставляйте побочные эффекты в `cmd/`.

## Testing Guidelines
Единичные тесты размещайте рядом с кодом (`*_test.go`) и описывайте сценарии через `testing` пакет. Используйте табличные тесты для покрытий граничных кейсов (например, нестабильные ZIP, пустые метаданные). Запускайте `go test ./...` локально; даже при отсутствии текущих тестов, ожидается покрывать новые функции регрессами и моками HTTP-запросов.

## Commit & Pull Request Guidelines
Форматируйте заголовок commit в повелительном наклонении (пример: `Add debounce for large zips`). Дополняйте описанием контекста и ссылками на issue при наличии. Для PR включайте: краткое резюме, тестовый чек-лист (`go test`, `go vet`, Docker-сборка при изменениях), и снимки логов, если правились потоки обработки. Поддерживайте PR небольшими и тематически цельными.

## Runtime & Operations Notes
Следите, чтобы архивы завершили запись перед помещением в `input/`; инструмент сам повторно проверит стабильность, но длительный аплоад может блокировать очередь. Для офлайн-режима используйте резервный путь метаданных (`anilist.go`) и при необходимости добавляйте ручные данные в статические мапы.
